<!DOCTYPE HTML>
<html lang="en">

<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Hexo">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="http://example.com">
    <!--SEO-->

<meta name="keywords" content="" />


<meta name="description" content="一 isinstance(obj,cls)和issubclass(sub,super)isinstance(obj,cls)检查是否obj是否是类 cls 的对象
1234561 class F..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->

<title>
    
    面向对象高级 |
    
    Hexo
</title>

<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    


<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">

    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>




    

<meta name="generator" content="Hexo 6.1.0"></head>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    /./img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='John Doe'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://example.com">
                        Hexo</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa fa-home"></i>
                                Home</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/"><i class="fa fa-th-list"></i>
                                文章分类</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/tags/"><i class="fa fa-tags"></i>
                                标签</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa fa-archive"></i>
                                归档</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="面向对象高级">
            
            面向对象高级
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a class="category-link" href="/categories/Python%E9%AB%98%E7%BA%A7/">Python高级</a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2017/03/02</span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="一-isinstance-obj-cls-和issubclass-sub-super"><a href="#一-isinstance-obj-cls-和issubclass-sub-super" class="headerlink" title="一 isinstance(obj,cls)和issubclass(sub,super)"></a>一 isinstance(obj,cls)和issubclass(sub,super)</h2><p><strong>isinstance(obj,cls)检查是否obj是否是类 cls 的对象</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">class</span> <span class="title class_">Foo</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="number">2</span>     <span class="keyword">pass</span></span><br><span class="line"><span class="number">3</span>  </span><br><span class="line"><span class="number">4</span> obj = Foo()</span><br><span class="line"><span class="number">5</span>  </span><br><span class="line"><span class="number">6</span> <span class="built_in">isinstance</span>(obj, Foo)</span><br></pre></td></tr></table></figure>

<p><strong>issubclass(sub, super)检查sub类是否是 super 类的派生类</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">class</span> <span class="title class_">Foo</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="number">2</span>     <span class="keyword">pass</span></span><br><span class="line"><span class="number">3</span>  </span><br><span class="line"><span class="number">4</span> <span class="keyword">class</span> <span class="title class_">Bar</span>(<span class="title class_ inherited__">Foo</span>):</span><br><span class="line"><span class="number">5</span>     <span class="keyword">pass</span></span><br><span class="line"><span class="number">6</span>  </span><br><span class="line"><span class="number">7</span> <span class="built_in">issubclass</span>(Bar, Foo)</span><br></pre></td></tr></table></figure>



<h2 id="二-反射"><a href="#二-反射" class="headerlink" title="二 反射"></a>二 反射</h2><p><strong>1 什么是反射</strong></p>
<p>反射的概念是由Smith在1982年首次提出的，主要是指程序可以访问、检测和修改它本身状态或行为的一种能力（自省）。这一概念的提出很快引发了计算机科学领域关于应用反射性的研究。它首先被程序语言的设计领域所采用,并在Lisp和面向对象方面取得了成绩。</p>
<p><strong>2 python面向对象中的反射：通过字符串的形式操作对象相关的属性。python中的一切事物都是对象（都可以使用反射）</strong></p>
<p>四个可以实现自省的函数</p>
<p>下列方法适用于类和对象（一切皆对象，类本身也是一个对象）</p>
<p><strong>hasattr(object,name)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hasattr</span>(<span class="params">*args, **kwargs</span>): <span class="comment"># real signature unknown</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Return whether the object has an attribute with the given name.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    This is done by calling getattr(obj, name) and catching AttributeError.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>getattr(object, name, default&#x3D;None)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getattr</span>(<span class="params"><span class="built_in">object</span>, name, default=<span class="literal">None</span></span>): <span class="comment"># known special case of getattr</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    getattr(object, name[, default]) -&gt; value</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Get a named attribute from an object; getattr(x, &#x27;y&#x27;) is equivalent to x.y.</span></span><br><span class="line"><span class="string">    When a default argument is given, it is returned when the attribute doesn&#x27;t</span></span><br><span class="line"><span class="string">    exist; without it, an exception is raised in that case.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>**setattr(x, y, v) **</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">setattr</span>(<span class="params">x, y, v</span>): <span class="comment"># real signature unknown; restored from __doc__</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Sets the named attribute on the given object to the specified value.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    setattr(x, &#x27;y&#x27;, v) is equivalent to ``x.y = v&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<p><strong>delattr(x, y)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">delattr</span>(<span class="params">x, y</span>): <span class="comment"># real signature unknown; restored from __doc__</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Deletes the named attribute from the given object.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    delattr(x, &#x27;y&#x27;) is equivalent to ``del x.y&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<p><strong>四个方法的使用演示</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BlackMedium</span>:</span><br><span class="line">    feature=<span class="string">&#x27;Ugly&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,addr</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.addr=addr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sell_house</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s 黑中介卖房子啦,傻逼才买呢,但是谁能证明自己不傻逼&#x27;</span> %self.name)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rent_house</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s 黑中介租房子啦,傻逼才租呢&#x27;</span> %self.name)</span><br><span class="line"></span><br><span class="line">b1=BlackMedium(<span class="string">&#x27;万成置地&#x27;</span>,<span class="string">&#x27;回龙观天露园&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#检测是否含有某属性</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hasattr</span>(b1,<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hasattr</span>(b1,<span class="string">&#x27;sell_house&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取属性</span></span><br><span class="line">n=<span class="built_in">getattr</span>(b1,<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">func=<span class="built_in">getattr</span>(b1,<span class="string">&#x27;rent_house&#x27;</span>)</span><br><span class="line">func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># getattr(b1,&#x27;aaaaaaaa&#x27;) #报错</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">getattr</span>(b1,<span class="string">&#x27;aaaaaaaa&#x27;</span>,<span class="string">&#x27;不存在啊&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置属性</span></span><br><span class="line"><span class="built_in">setattr</span>(b1,<span class="string">&#x27;sb&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">setattr</span>(b1,<span class="string">&#x27;show_name&#x27;</span>,<span class="keyword">lambda</span> self:self.name+<span class="string">&#x27;sb&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b1.__dict__)</span><br><span class="line"><span class="built_in">print</span>(b1.show_name(b1))</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除属性</span></span><br><span class="line"><span class="built_in">delattr</span>(b1,<span class="string">&#x27;addr&#x27;</span>)</span><br><span class="line"><span class="built_in">delattr</span>(b1,<span class="string">&#x27;show_name&#x27;</span>)</span><br><span class="line"><span class="built_in">delattr</span>(b1,<span class="string">&#x27;show_name111&#x27;</span>)<span class="comment">#不存在,则报错</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b1.__dict__)</span><br><span class="line"></span><br><span class="line">四个方法的使用演示</span><br></pre></td></tr></table></figure>



<p><strong>类也是对象</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"> </span><br><span class="line">    staticField = <span class="string">&quot;old boy&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.name = <span class="string">&#x27;wupeiqi&#x27;</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;func&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bar</span>():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;bar&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="built_in">getattr</span>(Foo, <span class="string">&#x27;staticField&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">getattr</span>(Foo, <span class="string">&#x27;func&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">getattr</span>(Foo, <span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>反射当前模块成员</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s1</span>():</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;s1&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2</span>():</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;s2&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">this_module = sys.modules[__name__]</span><br><span class="line"></span><br><span class="line"><span class="built_in">hasattr</span>(this_module, <span class="string">&#x27;s1&#x27;</span>)</span><br><span class="line"><span class="built_in">getattr</span>(this_module, <span class="string">&#x27;s2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">反射当前模块成员</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>导入其他模块，利用反射查找该模块是否存在某个方法</strong></p>
<p>module_test.py </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="comment">#!/usr/bin/env python</span></span><br><span class="line"> <span class="number">2</span> <span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"> <span class="number">3</span>  </span><br><span class="line"> <span class="number">4</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 5 程序目录：</span></span><br><span class="line"><span class="string"> 6     module_test.py</span></span><br><span class="line"><span class="string"> 7     index.py</span></span><br><span class="line"><span class="string"> 8  </span></span><br><span class="line"><span class="string"> 9 当前文件：</span></span><br><span class="line"><span class="string">10     index.py</span></span><br><span class="line"><span class="string">11 &quot;&quot;&quot;</span></span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span> <span class="keyword">import</span> module_test <span class="keyword">as</span> obj</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span> <span class="comment">#obj.test()</span></span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span> <span class="built_in">print</span>(<span class="built_in">hasattr</span>(obj,<span class="string">&#x27;test&#x27;</span>))</span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span> <span class="built_in">getattr</span>(obj,<span class="string">&#x27;test&#x27;</span>)()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3 为什么用反射之反射的好处</strong></p>
<p>好处一：实现可插拔机制</p>
<p>有俩程序员，一个lili，一个是egon，lili在写程序的时候需要用到egon所写的类，但是egon去跟女朋友度蜜月去了，还没有完成他写的类，lili想到了反射，使用了反射机制lili可以继续完成自己的代码，等egon度蜜月回来后再继续完成类的定义并且去实现lili想要的功能。</p>
<p>总之反射的好处就是，可以事先定义好接口，接口只有在被完成后才会真正执行，这实现了即插即用，这其实是一种‘后期绑定’，什么意思？即你可以事先把主要的逻辑写好（只定义接口），然后后期再去实现接口的功能</p>
<p>**egon还没有实现全部功能 **</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FtpClient</span>:</span><br><span class="line">    <span class="string">&quot;ftp客户端, 但是没有实现具体功能&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,addr</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>不影响lili的代码编写</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#from module import FtpClient</span></span><br><span class="line">f1=FtpClient(<span class="string">&#x27;192.168.1.1&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hasattr</span>(f1,<span class="string">&#x27;get&#x27;</span>):</span><br><span class="line">    func_get=<span class="built_in">getattr</span>(f1,<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line">    func_get()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----&gt;不存在此方法&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;处理其他的逻辑&#x27;</span>)</span><br><span class="line"></span><br><span class="line">不影响lili的代码编写</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>好处二：动态导入模块（基于反射当前模块成员）</p>
<p><img src="https://images2015.cnblogs.com/blog/1036857/201612/1036857-20161222125118901-555913707.png" alt="img"> </p>
<h2 id="三-setattr-delattr-getattr"><a href="#三-setattr-delattr-getattr" class="headerlink" title="三 setattr,delattr,getattr"></a>三 <strong>setattr</strong>,<strong>delattr</strong>,<strong>getattr</strong></h2><p><strong>三者的用法演示</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    x=<span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,y</span>):</span><br><span class="line">        self.y=y</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----&gt; from getattr:你找的属性不存在&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setattr__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----&gt; from setattr&#x27;</span>)</span><br><span class="line">        <span class="comment"># self.key=value #这就无限递归了,你好好想想</span></span><br><span class="line">        <span class="comment"># self.__dict__[key]=value #应该使用它</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----&gt; from delattr&#x27;</span>)</span><br><span class="line">        <span class="comment"># del self.item #无限递归了</span></span><br><span class="line">        self.__dict__.pop(item)</span><br><span class="line"></span><br><span class="line"><span class="comment">#__setattr__添加/修改属性会触发它的执行</span></span><br><span class="line">f1=Foo(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(f1.__dict__) <span class="comment"># 因为你重写了__setattr__,凡是赋值操作都会触发它的运行,你啥都没写,就是根本没赋值,除非你直接操作属性字典,否则永远无法赋值</span></span><br><span class="line">f1.z=<span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(f1.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#__delattr__删除属性的时候会触发</span></span><br><span class="line">f1.__dict__[<span class="string">&#x27;a&#x27;</span>]=<span class="number">3</span><span class="comment">#我们可以直接修改属性字典,来完成添加/修改属性的操作</span></span><br><span class="line"><span class="keyword">del</span> f1.a</span><br><span class="line"><span class="built_in">print</span>(f1.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#__getattr__只有在使用点调用属性且属性不存在的时候才会触发</span></span><br><span class="line">f1.xxxxxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="四-二次加工标准类型-包装"><a href="#四-二次加工标准类型-包装" class="headerlink" title="四 二次加工标准类型(包装)"></a>四 二次加工标准类型(包装)</h2><p>包装：python为大家提供了标准数据类型，以及丰富的内置方法，其实在很多场景下我们都需要基于标准数据类型来定制我们自己的数据类型，新增&#x2F;改写方法，这就用到了我们刚学的继承&#x2F;派生知识（其他的标准类型均可以通过下面的方式进行二次加工）</p>
<ul>
<li><p>二次加工标准类型(基于继承实现)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">List</span>(<span class="title class_ inherited__">list</span>): <span class="comment">#继承list所有的属性，也可以派生出自己新的，比如append和mid</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">append</span>(<span class="params">self, p_object</span>):</span><br><span class="line">        <span class="string">&#x27; 派生自己的append：加上类型检查&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(p_object,<span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;must be int&#x27;</span>)</span><br><span class="line">        <span class="built_in">super</span>().append(p_object)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mid</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;新增自己的属性&#x27;</span></span><br><span class="line">        index=<span class="built_in">len</span>(self)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> self[index]</span><br><span class="line"></span><br><span class="line">l=<span class="type">List</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line">l.append(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"><span class="comment"># l.append(&#x27;1111111&#x27;) #报错，必须为int类型</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(l.mid)</span><br><span class="line"></span><br><span class="line"><span class="comment">#其余的方法都继承list的</span></span><br><span class="line">l.insert(<span class="number">0</span>,-<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line">l.clear()</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line">二次加工标准类型(基于继承实现)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



</li>
<li><p>练习（clear加权限限制）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">List</span>(<span class="title class_ inherited__">list</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,item,tag=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(item)</span><br><span class="line">        self.tag=tag</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">append</span>(<span class="params">self, p_object</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(p_object,<span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError</span><br><span class="line">        <span class="built_in">super</span>().append(p_object)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clear</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.tag:</span><br><span class="line">            <span class="keyword">raise</span> PermissionError</span><br><span class="line">        <span class="built_in">super</span>().clear()</span><br><span class="line"></span><br><span class="line">l=<span class="type">List</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"><span class="built_in">print</span>(l.tag)</span><br><span class="line"></span><br><span class="line">l.append(<span class="string">&#x27;saf&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line"><span class="comment"># l.clear() #异常</span></span><br><span class="line"></span><br><span class="line">l.tag=<span class="literal">True</span></span><br><span class="line">l.clear()</span><br><span class="line"></span><br><span class="line">练习（clear加权限限制）</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>授权：授权是包装的一个特性, 包装一个类型通常是对已存在的类型的一些定制,这种做法可以新建,修改或删除原有产品的功能。其它的则保持原样。授权的过程,即是所有更新的功能都是由新类的某部分来处理,但已存在的功能就授权给对象的默认属性。</p>
<p>实现授权的关键点就是覆盖__getattr__方法</p>
<ul>
<li><p>授权示范一</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FileHandle</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,filename,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">        self.file=<span class="built_in">open</span>(filename,mode,encoding=encoding)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">self,line</span>):</span><br><span class="line">        t=time.strftime(<span class="string">&#x27;%Y-%m-%d %T&#x27;</span>)</span><br><span class="line">        self.file.write(<span class="string">&#x27;%s %s&#x27;</span> %(t,line))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self.file,item)</span><br><span class="line"></span><br><span class="line">f1=FileHandle(<span class="string">&#x27;b.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line">f1.write(<span class="string">&#x27;你好啊&#x27;</span>)</span><br><span class="line">f1.seek(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(f1.read())</span><br><span class="line">f1.close()</span><br><span class="line"></span><br><span class="line"> 授权示范一</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>授权示范二</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line"><span class="comment">#我们来加上b模式支持</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FileHandle</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,filename,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">in</span> mode:</span><br><span class="line">            self.file=<span class="built_in">open</span>(filename,mode)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.file=<span class="built_in">open</span>(filename,mode,encoding=encoding)</span><br><span class="line">        self.filename=filename</span><br><span class="line">        self.mode=mode</span><br><span class="line">        self.encoding=encoding</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">self,line</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">in</span> self.mode:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(line,<span class="built_in">bytes</span>):</span><br><span class="line">                <span class="keyword">raise</span> TypeError(<span class="string">&#x27;must be bytes&#x27;</span>)</span><br><span class="line">        self.file.write(line)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self.file,item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">in</span> self.mode:</span><br><span class="line">            res=<span class="string">&quot;&lt;_io.BufferedReader name=&#x27;%s&#x27;&gt;&quot;</span> %self.filename</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res=<span class="string">&quot;&lt;_io.TextIOWrapper name=&#x27;%s&#x27; mode=&#x27;%s&#x27; encoding=&#x27;%s&#x27;&gt;&quot;</span> %(self.filename,self.mode,self.encoding)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">f1=FileHandle(<span class="string">&#x27;b.txt&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="comment"># f1.write(&#x27;你好啊啊啊啊啊&#x27;) #自定制的write,不用在进行encode转成二进制去写了,简单,大气</span></span><br><span class="line">f1.write(<span class="string">&#x27;你好啊&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(f1)</span><br><span class="line">f1.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>练习题（授权）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#练习一</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">List</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seq</span>):</span><br><span class="line">        self.seq=seq</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">append</span>(<span class="params">self, p_object</span>):</span><br><span class="line">        <span class="string">&#x27; 派生自己的append加上类型检查，覆盖原有的append&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(p_object,<span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;must be int&#x27;</span>)</span><br><span class="line">        self.seq.append(p_object)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mid</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;新增自己的方法&#x27;</span></span><br><span class="line">        index=<span class="built_in">len</span>(self.seq)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> self.seq[index]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self.seq,item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(self.seq)</span><br><span class="line"></span><br><span class="line">l=<span class="type">List</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line">l.append(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"><span class="comment"># l.append(&#x27;3333333&#x27;) #报错，必须为int类型</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(l.mid)</span><br><span class="line"></span><br><span class="line"><span class="comment">#基于授权，获得insert方法</span></span><br><span class="line">l.insert(<span class="number">0</span>,-<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#练习二</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">List</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seq,permission=<span class="literal">False</span></span>):</span><br><span class="line">        self.seq=seq</span><br><span class="line">        self.permission=permission</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clear</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.permission:</span><br><span class="line">            <span class="keyword">raise</span> PermissionError(<span class="string">&#x27;not allow the operation&#x27;</span>)</span><br><span class="line">        self.seq.clear()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self.seq,item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(self.seq)</span><br><span class="line">l=<span class="type">List</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="comment"># l.clear() #此时没有权限，抛出异常</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l.permission=<span class="literal">True</span></span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line">l.clear()</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line"><span class="comment">#基于授权，获得insert方法</span></span><br><span class="line">l.insert(<span class="number">0</span>,-<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="五-getattribute"><a href="#五-getattribute" class="headerlink" title="五 __getattribute __"></a>五<code> __getattribute __</code></h2><ul>
<li><strong>回顾<code>__getattr__</code></strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,x</span>):</span><br><span class="line">        self.x=x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;执行的是我&#x27;</span>)</span><br><span class="line">        <span class="comment"># return self.__dict__[item]</span></span><br><span class="line"></span><br><span class="line">f1=Foo(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(f1.x)</span><br><span class="line">f1.xxxxxx <span class="comment">#不存在的属性访问，触发__getattr__</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li><code>__getattribute__</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,x</span>):</span><br><span class="line">        self.x=x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattribute__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;不管是否存在,我都会执行&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1=Foo(<span class="number">10</span>)</span><br><span class="line">f1.x</span><br><span class="line">f1.xxxxxx</span><br><span class="line"></span><br><span class="line">__getattribute__</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li><strong>二者同时出现</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,x</span>):</span><br><span class="line">        self.x=x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;执行的是我&#x27;</span>)</span><br><span class="line">        <span class="comment"># return self.__dict__[item]</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattribute__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;不管是否存在,我都会执行&#x27;</span>)</span><br><span class="line">        <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;哈哈&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1=Foo(<span class="number">10</span>)</span><br><span class="line">f1.x</span><br><span class="line">f1.xxxxxx</span><br><span class="line"></span><br><span class="line"><span class="comment">#当__getattribute__与__getattr__同时存在,只会执行__getattrbute__,除非__getattribute__在执行过程中抛出异常AttributeError</span></span><br><span class="line"></span><br><span class="line">二者同时出现</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="六-描述符-get-set-delete"><a href="#六-描述符-get-set-delete" class="headerlink" title="六 描述符(get,set,delete)"></a>六 描述符(<strong>get</strong>,<strong>set</strong>,<strong>delete</strong>)</h2><p>1 描述符是什么:描述符本质就是一个新式类,在这个新式类中,至少实现了__get__(),<strong>set</strong>(),<strong>delete</strong>()中的一个,这也被称为描述符协议<br><strong>get</strong>():调用一个属性时,触发<br><strong>set</strong>():为一个属性赋值时,触发<br><strong>delete</strong>():采用del删除属性时,触发</p>
<p><strong>定义一个描述符</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>: <span class="comment">#在python3中Foo是新式类,它实现了三种方法,这个类就被称作一个描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">定义一个描述符</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2 描述符是干什么的:描述符的作用是用来代理另外一个类的属性的(必须把描述符定义成这个类的类属性，不能定义到构造函数中)</p>
<p><strong>引子:描述符类产生的实例进行属性操作并不会触发三个方法的执行</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;触发get&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;触发set&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;触发delete&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#包含这三个方法的新式类称为描述符,由这个类产生的实例进行属性的调用/赋值/删除,并不会触发这三个方法</span></span><br><span class="line">f1=Foo()</span><br><span class="line">f1.name=<span class="string">&#x27;egon&#x27;</span></span><br><span class="line">f1.name</span><br><span class="line"><span class="keyword">del</span> f1.name</span><br><span class="line"><span class="comment">#疑问:何时,何地,会触发这三个方法的执行</span></span><br><span class="line"></span><br><span class="line">引子:描述符类产生的实例进行属性操作并不会触发三个方法的执行</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>描述符应用之何时?何地?</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#描述符Str</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str调用&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str设置...&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str删除...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#描述符Int</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Int</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Int调用&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Int设置...&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Int删除...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str()</span><br><span class="line">    age=Int()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age</span>): <span class="comment">#name被Str类代理,age被Int类代理,</span></span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line"></span><br><span class="line"><span class="comment">#何地？：定义成另外一个类的类属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#何时？：且看下列演示</span></span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;alex&#x27;</span>,<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#描述符Str的使用</span></span><br><span class="line">p1.name</span><br><span class="line">p1.name=<span class="string">&#x27;egon&#x27;</span></span><br><span class="line"><span class="keyword">del</span> p1.name</span><br><span class="line"></span><br><span class="line"><span class="comment">#描述符Int的使用</span></span><br><span class="line">p1.age</span><br><span class="line">p1.age=<span class="number">18</span></span><br><span class="line"><span class="keyword">del</span> p1.age</span><br><span class="line"></span><br><span class="line"><span class="comment">#我们来瞅瞅到底发生了什么</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"><span class="built_in">print</span>(People.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#补充</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(p1) == People) <span class="comment">#type(obj)其实是查看obj是由哪个类实例化来的</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(p1).__dict__ == People.__dict__)</span><br><span class="line"></span><br><span class="line">描述符应用之何时?何地?</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>3 描述符分两种<br>一 数据描述符:至少实现了__get__()和__set__()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 class Foo:</span><br><span class="line">2     def __set__(self, instance, value):</span><br><span class="line">3         print(&#x27;set&#x27;)</span><br><span class="line">4     def __get__(self, instance, owner):</span><br><span class="line">5         print(&#x27;get&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>二 非数据描述符:没有实现__set__()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 class Foo:</span><br><span class="line">2     def __get__(self, instance, owner):</span><br><span class="line">3         print(&#x27;get&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4 注意事项:</p>
<ul>
<li><p>一 描述符本身应该定义成新式类,被代理的类也应该是新式类</p>
</li>
<li><p>二 必须把描述符定义成这个类的类属性，不能为定义到构造函数中</p>
</li>
<li><p>三 要严格遵循该优先级,优先级由高到底分别是</p>
<ul>
<li><p>1.类属性</p>
</li>
<li><p>2.数据描述符</p>
</li>
<li><p>3.实例属性</p>
</li>
<li><p>4.非数据描述符</p>
</li>
</ul>
</li>
<li><p>5.找不到的属性触发__getattr__()</p>
<ul>
<li>类属性&gt;数据描述符</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#描述符Str</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str调用&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str设置...&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str删除...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age</span>): <span class="comment">#name被Str类代理,age被Int类代理,</span></span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#基于上面的演示,我们已经知道,在一个类中定义描述符它就是一个类属性,存在于类的属性字典中,而不是实例的属性字典</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#那既然描述符被定义成了一个类属性,直接通过类名也一定可以调用吧,没错</span></span><br><span class="line">People.name <span class="comment">#恩,调用类属性name,本质就是在调用描述符Str,触发了__get__()</span></span><br><span class="line"></span><br><span class="line">People.name=<span class="string">&#x27;egon&#x27;</span> <span class="comment">#那赋值呢,我去,并没有触发__set__()</span></span><br><span class="line"><span class="keyword">del</span> People.name <span class="comment">#赶紧试试del,我去,也没有触发__delete__()</span></span><br><span class="line"><span class="comment">#结论:描述符对类没有作用--------&gt;傻逼到家的结论</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">原因:描述符在使用时被定义成另外一个类的类属性,因而类属性比二次加工的描述符伪装而来的类属性有更高的优先级</span></span><br><span class="line"><span class="string">People.name #恩,调用类属性name,找不到就去找描述符伪装的类属性name,触发了__get__()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">People.name=&#x27;egon&#x27; #那赋值呢,直接赋值了一个类属性,它拥有更高的优先级,相当于覆盖了描述符,肯定不会触发描述符的__set__()</span></span><br><span class="line"><span class="string">del People.name #同上</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>数据描述符&gt;实例属性</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#描述符Str</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str调用&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str设置...&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Str删除...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age</span>): <span class="comment">#name被Str类代理,age被Int类代理,</span></span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果描述符是一个数据描述符(即有__get__又有__set__),那么p1.name的调用与赋值都是触发描述符的操作,于p1本身无关了,相当于覆盖了实例的属性</span></span><br><span class="line">p1.name=<span class="string">&#x27;egonnnnnn&#x27;</span></span><br><span class="line">p1.name</span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)<span class="comment">#实例的属性字典中没有name,因为name是一个数据描述符,优先级高于实例属性,查看/赋值/删除都是跟描述符有关,与实例无关了</span></span><br><span class="line"><span class="keyword">del</span> p1.name</span><br><span class="line"></span><br><span class="line">数据描述符&gt;实例属性</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<ul>
<li><p>实例属性&gt;非数据描述符 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;我胡汉三又回来了&#x27;</span>)</span><br><span class="line">f1=Foo()</span><br><span class="line">f1.func() <span class="comment">#调用类的方法,也可以说是调用非数据描述符</span></span><br><span class="line"><span class="comment">#函数是一个非数据描述符对象(一切皆对象么)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(Foo.func))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hasattr</span>(Foo.func,<span class="string">&#x27;__set__&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hasattr</span>(Foo.func,<span class="string">&#x27;__get__&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hasattr</span>(Foo.func,<span class="string">&#x27;__delete__&#x27;</span>))</span><br><span class="line"><span class="comment">#有人可能会问,描述符不都是类么,函数怎么算也应该是一个对象啊,怎么就是描述符了</span></span><br><span class="line"><span class="comment">#笨蛋哥,描述符是类没问题,描述符在应用的时候不都是实例化成一个类属性么</span></span><br><span class="line"><span class="comment">#函数就是一个由非描述符类实例化得到的对象</span></span><br><span class="line"><span class="comment">#没错，字符串也一样</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1.func=<span class="string">&#x27;这是实例属性啊&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(f1.func)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> f1.func <span class="comment">#删掉了非数据</span></span><br><span class="line">f1.func()</span><br><span class="line"></span><br><span class="line">实例属性&gt;非数据描述符</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>再次验证：实例属性&gt;非数据描述符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    name=Foo()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#name是一个数据描述符,因为name=Foo()而Foo实现了get和set方法,因而比实例属性有更高的优先级</span></span><br><span class="line"><span class="comment">#对实例的属性操作,触发的都是描述符的</span></span><br><span class="line">r1=Room(<span class="string">&#x27;厕所&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">r1.name</span><br><span class="line">r1.name=<span class="string">&#x27;厨房&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    name=Foo()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#name是一个非数据描述符,因为name=Foo()而Foo没有实现set方法,因而比实例属性有更低的优先级</span></span><br><span class="line"><span class="comment">#对实例的属性操作,触发的都是实例自己的</span></span><br><span class="line">r1=Room(<span class="string">&#x27;厕所&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">r1.name</span><br><span class="line">r1.name=<span class="string">&#x27;厨房&#x27;</span></span><br><span class="line"></span><br><span class="line">再次验证：实例属性&gt;非数据描述符</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>非数据描述符&gt;找不到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;我胡汉三又回来了&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;找不到了当然是来找我啦&#x27;</span>,item)</span><br><span class="line">f1=Foo()</span><br><span class="line"></span><br><span class="line">f1.xxxxxxxxxxx</span><br><span class="line"></span><br><span class="line">非数据描述符&gt;找不到</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>5 描述符使用</p>
<p>众所周知，python是弱类型语言，即参数的赋值没有类型限制，下面我们通过描述符机制来实现类型限制功能</p>
<p>牛刀小试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>,<span class="number">3231.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line">p1.name</span><br><span class="line"></span><br><span class="line"><span class="comment">#赋值</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line">p1.name=<span class="string">&#x27;egonlin&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"><span class="keyword">del</span> p1.name</span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>拔刀相助</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line"><span class="comment">#疑问:如果我用类名去操作属性呢</span></span><br><span class="line">People.name <span class="comment">#报错,错误的根源在于类去操作属性时,会把None传给instance</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#修订__get__方法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"><span class="built_in">print</span>(People.name) <span class="comment">#完美,解决</span></span><br><span class="line"></span><br><span class="line">拔刀相助</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>磨刀霍霍</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Str</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,expected_type</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.expected_type=expected_type</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value,self.expected_type): <span class="comment">#如果不是期望的类型，则抛出异常</span></span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;Expected %s&#x27;</span> %<span class="built_in">str</span>(self.expected_type))</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Str(<span class="string">&#x27;name&#x27;</span>,<span class="built_in">str</span>) <span class="comment">#新增类型限制str</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line">p1=People(<span class="number">123</span>,<span class="number">18</span>,<span class="number">3333.3</span>)<span class="comment">#传入的name因不是字符串类型而抛出异常</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>大刀阔斧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Typed</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,expected_type</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.expected_type=expected_type</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value,self.expected_type):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;Expected %s&#x27;</span> %<span class="built_in">str</span>(self.expected_type))</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=Typed(<span class="string">&#x27;name&#x27;</span>,<span class="built_in">str</span>)</span><br><span class="line">    age=Typed(<span class="string">&#x27;name&#x27;</span>,<span class="built_in">int</span>)</span><br><span class="line">    salary=Typed(<span class="string">&#x27;name&#x27;</span>,<span class="built_in">float</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line">p1=People(<span class="number">123</span>,<span class="number">18</span>,<span class="number">3333.3</span>)</span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;18&#x27;</span>,<span class="number">3333.3</span>)</span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>,<span class="number">3333</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>大刀阔斧之后我们已然能实现功能了，但是问题是，如果我们的类有很多属性，你仍然采用在定义一堆类属性的方式去实现，low，这时候我需要教你一招：独孤九剑</p>
<p>类的装饰器:无参</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decorate</span>(<span class="params">cls</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;类的装饰器开始运行啦------&gt;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> cls</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorate </span><span class="comment">#无参:People=decorate(People)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>,<span class="number">3333.3</span>)</span><br><span class="line"></span><br><span class="line">类的装饰器:无参</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>类的装饰器:有参</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">typeassert</span>(<span class="params">**kwargs</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorate</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;类的装饰器开始运行啦------&gt;&#x27;</span>,kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls</span><br><span class="line">    <span class="keyword">return</span> decorate</span><br><span class="line"><span class="meta">@typeassert(<span class="params">name=<span class="built_in">str</span>,age=<span class="built_in">int</span>,salary=<span class="built_in">float</span></span>) </span><span class="comment">#有参:1.运行typeassert(...)返回结果是decorate,此时参数都传给kwargs 2.People=decorate(People)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>,<span class="number">3333.3</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>终极大招</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Typed</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,expected_type</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.expected_type=expected_type</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get---&gt;&#x27;</span>,instance,owner)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> instance.__dict__[self.name]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set---&gt;&#x27;</span>,instance,value)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value,self.expected_type):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;Expected %s&#x27;</span> %<span class="built_in">str</span>(self.expected_type))</span><br><span class="line">        instance.__dict__[self.name]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete---&gt;&#x27;</span>,instance)</span><br><span class="line">        instance.__dict__.pop(self.name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">typeassert</span>(<span class="params">**kwargs</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorate</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;类的装饰器开始运行啦------&gt;&#x27;</span>,kwargs)</span><br><span class="line">        <span class="keyword">for</span> name,expected_type <span class="keyword">in</span> kwargs.items():</span><br><span class="line">            <span class="built_in">setattr</span>(cls,name,Typed(name,expected_type))</span><br><span class="line">        <span class="keyword">return</span> cls</span><br><span class="line">    <span class="keyword">return</span> decorate</span><br><span class="line"><span class="meta">@typeassert(<span class="params">name=<span class="built_in">str</span>,age=<span class="built_in">int</span>,salary=<span class="built_in">float</span></span>) </span><span class="comment">#有参:1.运行typeassert(...)返回结果是decorate,此时参数都传给kwargs 2.People=decorate(People)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age,salary</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">        self.salary=salary</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(People.__dict__)</span><br><span class="line">p1=People(<span class="string">&#x27;egon&#x27;</span>,<span class="number">18</span>,<span class="number">3333.3</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>6 描述符总结</p>
<p>描述符是可以实现大部分python类特性中的底层魔法,包括@classmethod,@staticmethd,@property甚至是__slots__属性</p>
<p>描述父是很多高级库和框架的重要工具之一,描述符通常是使用到装饰器或者元类的大型框架中的一个组件.</p>
<p>7 利用描述符原理完成一个自定制@property,实现延迟计算（本质就是把一个函数属性利用装饰器原理做成一个描述符：类的属性字典中函数名为key，value为描述符类产生的对象）</p>
<p>@property回顾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.width * self.length</span><br><span class="line"></span><br><span class="line">r1=Room(<span class="string">&#x27;alex&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r1.area)</span><br><span class="line"></span><br><span class="line"><span class="meta">@property回顾</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>自己做一个@property</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Lazyproperty</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;这是我们自己定制的静态属性,r1.area实际是要执行r1.area()&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">return</span> self.func(instance) <span class="comment">#此时你应该明白,到底是谁在为你做自动传递self的事情</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"><span class="meta">    @Lazyproperty </span><span class="comment">#area=Lazyproperty(area) 相当于定义了一个类属性,即描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.width * self.length</span><br><span class="line"></span><br><span class="line">r1=Room(<span class="string">&#x27;alex&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r1.area)</span><br><span class="line"></span><br><span class="line">自己做一个@<span class="built_in">property</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>实现延迟计算功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Lazyproperty</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;这是我们自己定制的静态属性,r1.area实际是要执行r1.area()&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;---&gt;&#x27;</span>)</span><br><span class="line">            value=self.func(instance)</span><br><span class="line">            <span class="built_in">setattr</span>(instance,self.func.__name__,value) <span class="comment">#计算一次就缓存到实例的属性字典中</span></span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"><span class="meta">    @Lazyproperty </span><span class="comment">#area=Lazyproperty(area) 相当于&#x27;定义了一个类属性,即描述符&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.width * self.length</span><br><span class="line"></span><br><span class="line">r1=Room(<span class="string">&#x27;alex&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r1.area) <span class="comment">#先从自己的属性字典找,没有再去类的中找,然后出发了area的__get__方法</span></span><br><span class="line"><span class="built_in">print</span>(r1.area) <span class="comment">#先从自己的属性字典找,找到了,是上次计算的结果,这样就不用每执行一次都去计算</span></span><br><span class="line"></span><br><span class="line">实现延迟计算功能</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>一个小的改动，延迟计算的美梦就破碎了 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#缓存不起来了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Lazyproperty</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;这是我们自己定制的静态属性,r1.area实际是要执行r1.area()&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value=self.func(instance)</span><br><span class="line">            instance.__dict__[self.func.__name__]=value</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">        <span class="comment"># return self.func(instance) #此时你应该明白,到底是谁在为你做自动传递self的事情</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;hahahahahah&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Room</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,width,length</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.width=width</span><br><span class="line">        self.length=length</span><br><span class="line"></span><br><span class="line"><span class="meta">    @Lazyproperty </span><span class="comment">#area=Lazyproperty(area) 相当于定义了一个类属性,即描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.width * self.length</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Room.__dict__)</span><br><span class="line">r1=Room(<span class="string">&#x27;alex&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r1.area)</span><br><span class="line"><span class="built_in">print</span>(r1.area) </span><br><span class="line"><span class="built_in">print</span>(r1.area) </span><br><span class="line"><span class="built_in">print</span>(r1.area) <span class="comment">#缓存功能失效,每次都去找描述符了,为何,因为描述符实现了set方法,它由非数据描述符变成了数据描述符,数据描述符比实例属性有更高的优先级,因而所有的属性操作都去找描述符了</span></span><br><span class="line"></span><br><span class="line">一个小的改动，延迟计算的美梦就破碎了</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>8 利用描述符原理完成一个自定制@classmethod</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassMethod</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>): <span class="comment">#类来调用,instance为None,owner为类本身,实例来调用,instance为实例,owner为类本身,</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">feedback</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;在这里可以加功能啊...&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> self.func(owner)</span><br><span class="line">        <span class="keyword">return</span> feedback</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=<span class="string">&#x27;linhaifeng&#x27;</span></span><br><span class="line"><span class="meta">    @ClassMethod </span><span class="comment"># say_hi=ClassMethod(say_hi)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;你好啊,帅哥 %s&#x27;</span> %cls.name)</span><br><span class="line"></span><br><span class="line">People.say_hi()</span><br><span class="line"></span><br><span class="line">p1=People()</span><br><span class="line">p1.say_hi()</span><br><span class="line"><span class="comment">#疑问,类方法如果有参数呢,好说,好说</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ClassMethod</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>): <span class="comment">#类来调用,instance为None,owner为类本身,实例来调用,instance为实例,owner为类本身,</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">feedback</span>(<span class="params">*args,**kwargs</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;在这里可以加功能啊...&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> self.func(owner,*args,**kwargs)</span><br><span class="line">        <span class="keyword">return</span> feedback</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    name=<span class="string">&#x27;linhaifeng&#x27;</span></span><br><span class="line"><span class="meta">    @ClassMethod </span><span class="comment"># say_hi=ClassMethod(say_hi)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params">cls,msg</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;你好啊,帅哥 %s %s&#x27;</span> %(cls.name,msg))</span><br><span class="line"></span><br><span class="line">People.say_hi(<span class="string">&#x27;你是那偷心的贼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p1=People()</span><br><span class="line">p1.say_hi(<span class="string">&#x27;你是那偷心的贼&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>9 利用描述符原理完成一个自定制的@staticmethod</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StaticMethod</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func</span>):</span><br><span class="line">        self.func=func</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>): <span class="comment">#类来调用,instance为None,owner为类本身,实例来调用,instance为实例,owner为类本身,</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">feedback</span>(<span class="params">*args,**kwargs</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;在这里可以加功能啊...&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> self.func(*args,**kwargs)</span><br><span class="line">        <span class="keyword">return</span> feedback</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line"><span class="meta">    @StaticMethod</span><span class="comment"># say_hi=StaticMethod(say_hi)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params">x,y,z</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;------&gt;&#x27;</span>,x,y,z)</span><br><span class="line"></span><br><span class="line">People.say_hi(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">p1=People()</span><br><span class="line">p1.say_hi(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">自己做一个@<span class="built_in">staticmethod</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="六-再看property"><a href="#六-再看property" class="headerlink" title="六 再看property"></a>六 再看property</h2><p>一个静态属性property本质就是实现了get，set，delete三种方法</p>
<p>用法一</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">AAA</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get的时候运行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @AAA.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">AAA</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set的时候运行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @AAA.deleter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">AAA</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete的时候运行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#只有在属性AAA定义property后才能定义AAA.setter,AAA.deleter</span></span><br><span class="line">f1=Foo()</span><br><span class="line">f1.AAA</span><br><span class="line">f1.AAA=<span class="string">&#x27;aaa&#x27;</span></span><br><span class="line"><span class="keyword">del</span> f1.AAA</span><br><span class="line"></span><br><span class="line">用法一</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>用法二</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_AAA</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get的时候运行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_AAA</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set的时候运行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">delete_AAA</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete的时候运行我啊&#x27;</span>)</span><br><span class="line">    AAA=<span class="built_in">property</span>(get_AAA,set_AAA,delete_AAA) <span class="comment">#内置property三个参数与get,set,delete一一对应</span></span><br><span class="line"></span><br><span class="line">f1=Foo()</span><br><span class="line">f1.AAA</span><br><span class="line">f1.AAA=<span class="string">&#x27;aaa&#x27;</span></span><br><span class="line"><span class="keyword">del</span> f1.AAA</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>怎么用？</strong></p>
<p>案例一</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Goods</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 原价</span></span><br><span class="line">        self.original_price = <span class="number">100</span></span><br><span class="line">        <span class="comment"># 折扣</span></span><br><span class="line">        self.discount = <span class="number">0.8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">price</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 实际价格 = 原价 * 折扣</span></span><br><span class="line">        new_price = self.original_price * self.discount</span><br><span class="line">        <span class="keyword">return</span> new_price</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">price</span>(<span class="params">self, value</span>):</span><br><span class="line">        self.original_price = value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.deleter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">price</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">del</span> self.original_price</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Goods()</span><br><span class="line">obj.price         <span class="comment"># 获取商品价格</span></span><br><span class="line">obj.price = <span class="number">200</span>   <span class="comment"># 修改商品原价</span></span><br><span class="line"><span class="built_in">print</span>(obj.price)</span><br><span class="line"><span class="keyword">del</span> obj.price     <span class="comment"># 删除商品原价</span></span><br><span class="line"></span><br><span class="line">案例一</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>案例二</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实现类型检测功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一关：</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line"><span class="comment"># p1=People(&#x27;alex&#x27;) #property自动实现了set和get方法属于数据描述符,比实例属性优先级高,所以你这面写会触发property内置的set,抛出异常</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二关：修订版</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name <span class="comment">#实例化就触发property</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># return self.name #无限递归</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get------&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.DouNiWan</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set------&gt;&#x27;</span>)</span><br><span class="line">        self.DouNiWan=value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.deleter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete------&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> self.DouNiWan</span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;alex&#x27;</span>) <span class="comment">#self.name实际是存放到self.DouNiWan里</span></span><br><span class="line"><span class="built_in">print</span>(p1.name)</span><br><span class="line"><span class="built_in">print</span>(p1.name)</span><br><span class="line"><span class="built_in">print</span>(p1.name)</span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"></span><br><span class="line">p1.name=<span class="string">&#x27;egon&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> p1.name</span><br><span class="line"><span class="built_in">print</span>(p1.__dict__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#第三关:加上类型检查</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name <span class="comment">#实例化就触发property</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># return self.name #无限递归</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get------&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.DouNiWan</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;set------&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value,<span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;必须是字符串类型&#x27;</span>)</span><br><span class="line">        self.DouNiWan=value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.deleter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;delete------&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> self.DouNiWan</span><br><span class="line"></span><br><span class="line">p1=People(<span class="string">&#x27;alex&#x27;</span>) <span class="comment">#self.name实际是存放到self.DouNiWan里</span></span><br><span class="line">p1.name=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">案例二</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="七-setitem-getitem-delitem"><a href="#七-setitem-getitem-delitem" class="headerlink" title="七 setitem,__getitem,delitem"></a>七 <strong>setitem</strong>,__getitem,<strong>delitem</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(self.__dict__[item])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        self.__dict__[key]=value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;del obj[key]时,我执行&#x27;</span>)</span><br><span class="line">        self.__dict__.pop(key)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;del obj.key时,我执行&#x27;</span>)</span><br><span class="line">        self.__dict__.pop(item)</span><br><span class="line"></span><br><span class="line">f1=Foo(<span class="string">&#x27;sb&#x27;</span>)</span><br><span class="line">f1[<span class="string">&#x27;age&#x27;</span>]=<span class="number">18</span></span><br><span class="line">f1[<span class="string">&#x27;age1&#x27;</span>]=<span class="number">19</span></span><br><span class="line"><span class="keyword">del</span> f1.age1</span><br><span class="line"><span class="keyword">del</span> f1[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">f1[<span class="string">&#x27;name&#x27;</span>]=<span class="string">&#x27;alex&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(f1.__dict__)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="八-str-repr-format"><a href="#八-str-repr-format" class="headerlink" title="八 str,repr,format"></a>八 <strong>str</strong>,<strong>repr</strong>,<strong>format</strong></h2><p>改变对象的字符串显示__str__,<strong>repr</strong></p>
<p>自定制格式化字符串__format__</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line">format_dict=&#123;</span><br><span class="line">    <span class="string">&#x27;nat&#x27;</span>:<span class="string">&#x27;&#123;obj.name&#125;-&#123;obj.addr&#125;-&#123;obj.type&#125;&#x27;</span>,<span class="comment">#学校名-学校地址-学校类型</span></span><br><span class="line">    <span class="string">&#x27;tna&#x27;</span>:<span class="string">&#x27;&#123;obj.type&#125;:&#123;obj.name&#125;:&#123;obj.addr&#125;&#x27;</span>,<span class="comment">#学校类型:学校名:学校地址</span></span><br><span class="line">    <span class="string">&#x27;tan&#x27;</span>:<span class="string">&#x27;&#123;obj.type&#125;/&#123;obj.addr&#125;/&#123;obj.name&#125;&#x27;</span>,<span class="comment">#学校类型/学校地址/学校名</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">School</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,addr,<span class="built_in">type</span></span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.addr=addr</span><br><span class="line">        self.<span class="built_in">type</span>=<span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;School(%s,%s)&#x27;</span> %(self.name,self.addr)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;(%s,%s)&#x27;</span> %(self.name,self.addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__format__</span>(<span class="params">self, format_spec</span>):</span><br><span class="line">        <span class="comment"># if format_spec</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> format_spec <span class="keyword">or</span> format_spec <span class="keyword">not</span> <span class="keyword">in</span> format_dict:</span><br><span class="line">            format_spec=<span class="string">&#x27;nat&#x27;</span></span><br><span class="line">        fmt=format_dict[format_spec]</span><br><span class="line">        <span class="keyword">return</span> fmt.<span class="built_in">format</span>(obj=self)</span><br><span class="line"></span><br><span class="line">s1=School(<span class="string">&#x27;oldboy1&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>,<span class="string">&#x27;私立&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;from repr: &#x27;</span>,<span class="built_in">repr</span>(s1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;from str: &#x27;</span>,<span class="built_in">str</span>(s1))</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">str函数或者print函数---&gt;obj.__str__()</span></span><br><span class="line"><span class="string">repr或者交互式解释器---&gt;obj.__repr__()</span></span><br><span class="line"><span class="string">如果__str__没有被定义,那么就会使用__repr__来代替输出</span></span><br><span class="line"><span class="string">注意:这俩方法的返回值必须是字符串,否则抛出异常</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(s1,<span class="string">&#x27;nat&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(s1,<span class="string">&#x27;tna&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(s1,<span class="string">&#x27;tan&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(s1,<span class="string">&#x27;asfdasdffd&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>自定义format练习 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">date_dic=&#123;</span><br><span class="line">    <span class="string">&#x27;ymd&#x27;</span>:<span class="string">&#x27;&#123;0.year&#125;:&#123;0.month&#125;:&#123;0.day&#125;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dmy&#x27;</span>:<span class="string">&#x27;&#123;0.day&#125;/&#123;0.month&#125;/&#123;0.year&#125;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mdy&#x27;</span>:<span class="string">&#x27;&#123;0.month&#125;-&#123;0.day&#125;-&#123;0.year&#125;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,year,month,day</span>):</span><br><span class="line">        self.year=year</span><br><span class="line">        self.month=month</span><br><span class="line">        self.day=day</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__format__</span>(<span class="params">self, format_spec</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> format_spec <span class="keyword">or</span> format_spec <span class="keyword">not</span> <span class="keyword">in</span> date_dic:</span><br><span class="line">            format_spec=<span class="string">&#x27;ymd&#x27;</span></span><br><span class="line">        fmt=date_dic[format_spec]</span><br><span class="line">        <span class="keyword">return</span> fmt.<span class="built_in">format</span>(self)</span><br><span class="line"></span><br><span class="line">d1=Date(<span class="number">2016</span>,<span class="number">12</span>,<span class="number">29</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(d1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#123;:mdy&#125;&#x27;</span>.<span class="built_in">format</span>(d1))</span><br><span class="line"></span><br><span class="line">自定义<span class="built_in">format</span>练习</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>issubclass和isinstance</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">issubclass</span>(B,A)) <span class="comment">#B是A的子类,返回True</span></span><br><span class="line"></span><br><span class="line">a1=A()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">isinstance</span>(a1,A)) <span class="comment">#a1是A的实例</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">issubclass</span>和<span class="built_in">isinstance</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="九-slots"><a href="#九-slots" class="headerlink" title="九  __slots__"></a>九 <code> __slots__</code></h2><p>__slots__使用 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1.__slots__是什么:是一个类变量,变量值可以是列表,元祖,或者可迭代对象,也可以是一个字符串(意味着所有实例只有一个数据属性)</span></span><br><span class="line"><span class="string">2.引子:使用点来访问属性本质就是在访问类或者对象的__dict__属性字典(类的字典是共享的,而每个实例的是独立的)</span></span><br><span class="line"><span class="string">3.为何使用__slots__:字典会占用大量内存,如果你有一个属性很少的类,但是有很多实例,为了节省内存可以使用__slots__取代实例的__dict__</span></span><br><span class="line"><span class="string">当你定义__slots__后,__slots__就会为实例使用一种更加紧凑的内部表示。实例通过一个很小的固定大小的数组来构建,而不是为每个实例定义一个</span></span><br><span class="line"><span class="string">字典,这跟元组或列表很类似。在__slots__中列出的属性名在内部被映射到这个数组的指定小标上。使用__slots__一个不好的地方就是我们不能再给</span></span><br><span class="line"><span class="string">实例添加新的属性了,只能使用在__slots__中定义的那些属性名。</span></span><br><span class="line"><span class="string">4.注意事项:__slots__的很多特性都依赖于普通的基于字典的实现。另外,定义了__slots__后的类不再 支持一些普通类特性了,比如多继承。大多数情况下,你应该</span></span><br><span class="line"><span class="string">只在那些经常被使用到 的用作数据结构的类上定义__slots__比如在程序中需要创建某个类的几百万个实例对象 。</span></span><br><span class="line"><span class="string">关于__slots__的一个常见误区是它可以作为一个封装工具来防止用户给实例增加新的属性。尽管使用__slots__可以达到这样的目的,但是这个并不是它的初衷。           更多的是用来作为一个内存优化工具。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    __slots__=<span class="string">&#x27;x&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1=Foo()</span><br><span class="line">f1.x=<span class="number">1</span></span><br><span class="line">f1.y=<span class="number">2</span><span class="comment">#报错</span></span><br><span class="line"><span class="built_in">print</span>(f1.__slots__) <span class="comment">#f1不再有__dict__</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bar</span>:</span><br><span class="line">    __slots__=[<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">n=Bar()</span><br><span class="line">n.x,n.y=<span class="number">1</span>,<span class="number">2</span></span><br><span class="line">n.z=<span class="number">3</span><span class="comment">#报错</span></span><br><span class="line"></span><br><span class="line">__slots__使用</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>刨根问底</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    __slots__=[<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line"></span><br><span class="line">f1=Foo()</span><br><span class="line">f1.name=<span class="string">&#x27;alex&#x27;</span></span><br><span class="line">f1.age=<span class="number">18</span></span><br><span class="line"><span class="built_in">print</span>(f1.__slots__)</span><br><span class="line"></span><br><span class="line">f2=Foo()</span><br><span class="line">f2.name=<span class="string">&#x27;egon&#x27;</span></span><br><span class="line">f2.age=<span class="number">19</span></span><br><span class="line"><span class="built_in">print</span>(f2.__slots__)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Foo.__dict__)</span><br><span class="line"><span class="comment">#f1与f2都没有属性字典__dict__了,统一归__slots__管,节省内存</span></span><br><span class="line"></span><br><span class="line">刨根问底</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="十-next-和-iter-实现迭代器协议"><a href="#十-next-和-iter-实现迭代器协议" class="headerlink" title="十 __next__和__iter__实现迭代器协议"></a>十 <code>__next__</code>和<code>__iter__</code>实现迭代器协议</h2><p>简单示范</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,x</span>):</span><br><span class="line">        self.x=x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        n=self.x</span><br><span class="line">        self.x+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.x</span><br><span class="line"></span><br><span class="line">f=Foo(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line">简单示范</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,start,stop</span>):</span><br><span class="line">        self.num=start</span><br><span class="line">        self.stop=stop</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.num &gt;= self.stop:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line">        n=self.num</span><br><span class="line">        self.num+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">f=Foo(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable,Iterator</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">isinstance</span>(f,Iterator))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Foo(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(i) </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>练习：简单模拟range，加上步长</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Range</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,n,stop,step</span>):</span><br><span class="line">        self.n=n</span><br><span class="line">        self.stop=stop</span><br><span class="line">        self.step=step</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.n &gt;= self.stop:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line">        x=self.n</span><br><span class="line">        self.n+=self.step</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Range(<span class="number">1</span>,<span class="number">7</span>,<span class="number">3</span>): <span class="comment">#</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line">练习：简单模拟<span class="built_in">range</span>，加上步长</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>斐波那契数列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fib</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._a=<span class="number">0</span></span><br><span class="line">        self._b=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        self._a,self._b=self._b,self._a + self._b</span><br><span class="line">        <span class="keyword">return</span> self._a</span><br><span class="line"></span><br><span class="line">f1=Fib()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1.__next__())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(f1))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(f1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f1:</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s &#x27;</span> %i,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="十一-doc"><a href="#十一-doc" class="headerlink" title="十一 __doc__"></a>十一 <code>__doc__</code></h2><p>它类的描述信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;我是描述信息&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(Foo.__doc__)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>该属性无法被继承</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="string">&#x27;我是描述信息&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bar</span>(<span class="title class_ inherited__">Foo</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(Bar.__doc__) <span class="comment">#该属性无法继承给子类</span></span><br><span class="line"></span><br><span class="line">该属性无法被继承</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="十二-module-和-class"><a href="#十二-module-和-class" class="headerlink" title="十二 __module__和__class__"></a>十二 <code>__module__</code>和<code>__class__</code></h2><p>　　<figure class="highlight plaintext"><figcaption><span>```表示当前操作的对象在那个模块</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">　　```__class__ ```  表示当前操作的对象的类是什么</span><br><span class="line"></span><br><span class="line">- lib/aa.py</span><br><span class="line"></span><br><span class="line">```python  </span><br><span class="line">class C:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.name = &quot;sb&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>index.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.aa <span class="keyword">import</span> C</span><br><span class="line">obj = C()</span><br><span class="line"><span class="built_in">print</span> obj._module__ <span class="comment"># 输出 lib.aa,  即输出模块</span></span><br><span class="line"><span class="built_in">print</span> obj.__class__ <span class="comment"># 输出 lib.aa.C  即输出类</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="十三-del"><a href="#十三-del" class="headerlink" title="十三  __del__"></a>十三  <code>__del__</code></h2><p>析构方法，当对象在内存中被释放时，自动触发执行。</p>
<p>注：如果产生的对象仅仅只是python程序级别的（用户级），那么无需定义__del__,如果产生的对象的同时还会向操作系统发起系统调用，即一个对象有用户级与内核级两种资源，比如（打开一个文件，创建一个数据库链接），则必须在清除对象的同时回收系统资源，这就用到了__del__</p>
<p>简单示范</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;执行我啦&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1=Foo()</span><br><span class="line"><span class="keyword">del</span> f1</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-------&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出结果</span></span><br><span class="line">执行我啦</span><br><span class="line">-------&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>挖坑埋了你</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;执行我啦&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1=Foo()</span><br><span class="line"><span class="comment"># del f1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-------&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出结果</span></span><br><span class="line">-------&gt;</span><br><span class="line">执行我啦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#为何啊？？？</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>典型的应用场景：</p>
<p>创建数据库类，用该类实例化出数据库链接对象，对象本身是存放于用户空间内存中，而链接则是由操作系统管理的，存放于内核空间内存中</p>
<p>当程序结束时，python只会回收自己的内存空间，即用户态内存，而操作系统的资源则没有被回收，这就需要我们定制__del__，在对象被删除前向操作系统发起关闭数据库链接的系统调用，回收资源</p>
<p>这与文件处理是一个道理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;a.txt&#x27;</span>) <span class="comment">#做了两件事，在用户空间拿到一个f变量，在操作系统内核空间打开一个文件</span></span><br><span class="line"><span class="keyword">del</span> f <span class="comment">#只回收用户空间的f，操作系统的文件还处于打开状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#所以我们应该在del f之前保证f.close()执行,即便是没有del，程序执行完毕也会自动del清理资源，于是文件操作的正确用法应该是</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;a.txt&#x27;</span>)</span><br><span class="line">读写...</span><br><span class="line">f.close()</span><br><span class="line">很多情况下大家都容易忽略f.close,这就用到了<span class="keyword">with</span>上下文管理</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="十四-enter-和-exit"><a href="#十四-enter-和-exit" class="headerlink" title="十四 __enter__和__exit__"></a>十四 <code>__enter__</code>和<code>__exit__</code></h2><p>我们知道在操作文件对象的时候可以这么写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 with open(&#x27;a.txt&#x27;) as f:</span><br><span class="line">2 　　&#x27;代码块&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上述叫做上下文管理协议，即with语句，为了让一个对象兼容with语句，必须在这个对象的类中声明__enter__和__exit__方法</p>
<p>上下文管理协议 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Open</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;出现with语句,对象的__enter__被触发,有返回值则赋值给as声明的变量&#x27;</span>)</span><br><span class="line">        <span class="comment"># return self</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;with中代码块执行完毕时执行我啊&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Open(<span class="string">&#x27;a.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=====&gt;执行代码块&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(f,f.name)</span></span><br><span class="line"></span><br><span class="line">上下文管理协议</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```python</span><br><span class="line">class Open:</span><br><span class="line">    def __init__(self,name):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line">    def __enter__(self):</span><br><span class="line">        print(&#x27;出现with语句,对象的__enter__被触发,有返回值则赋值给as声明的变量&#x27;)</span><br><span class="line"></span><br><span class="line">    def __exit__(self, exc_type, exc_val, exc_tb):</span><br><span class="line">        print(&#x27;with中代码块执行完毕时执行我啊&#x27;)</span><br><span class="line">        print(exc_type)</span><br><span class="line">        print(exc_val)</span><br><span class="line">        print(exc_tb)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with Open(&#x27;a.txt&#x27;) as f:</span><br><span class="line">    print(&#x27;=====&gt;执行代码块&#x27;)</span><br><span class="line">    raise AttributeError(&#x27;***着火啦,救火啊***&#x27;)</span><br><span class="line">print(&#x27;0&#x27;*100) #-------------------------------&gt;不会执行</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>如果<code>__exit__()</code>返回值为True,那么异常会被清空，就好像啥都没发生一样，with后的语句正常执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Open</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;出现with语句,对象的__enter__被触发,有返回值则赋值给as声明的变量&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;with中代码块执行完毕时执行我啊&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(exc_type)</span><br><span class="line">        <span class="built_in">print</span>(exc_val)</span><br><span class="line">        <span class="built_in">print</span>(exc_tb)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Open(<span class="string">&#x27;a.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=====&gt;执行代码块&#x27;</span>)</span><br><span class="line">    <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;***着火啦,救火啊***&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;0&#x27;</span>*<span class="number">100</span>) <span class="comment">#-------------------------------&gt;会执行</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>练习：模拟Open</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Open</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,filepath,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">        self.filepath=filepath</span><br><span class="line">        self.mode=mode</span><br><span class="line">        self.encoding=encoding</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># print(&#x27;enter&#x27;)</span></span><br><span class="line">        self.f=<span class="built_in">open</span>(self.filepath,mode=self.mode,encoding=self.encoding)</span><br><span class="line">        <span class="keyword">return</span> self.f</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span><br><span class="line">        <span class="comment"># print(&#x27;exit&#x27;)</span></span><br><span class="line">        self.f.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self.f,item)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Open(<span class="string">&#x27;a.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f)</span><br><span class="line">    f.write(<span class="string">&#x27;aaaaaa&#x27;</span>)</span><br><span class="line">    f.wasdf <span class="comment">#抛出异常，交给__exit__处理</span></span><br><span class="line"></span><br><span class="line">练习：模拟Open</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>用途或者说好处：</p>
<p>1.使用with语句的目的就是把代码块放入with中执行，with结束后，自动完成清理工作，无须手动干预</p>
<p>2.在需要管理一些资源比如文件，网络连接和锁的编程环境中，可以在__exit__中定制自动释放资源的机制，你无须再去关系这个问题，这将大有用处</p>
<h1 id="十五-call"><a href="#十五-call" class="headerlink" title="十五 call"></a>十五 <strong>call</strong></h1><p>对象后面加括号，触发执行。</p>
<p>注：构造方法的执行是由创建对象触发的，即：对象 &#x3D; 类名() ；而对于 <strong>call</strong> 方法的执行是由对象后加括号触发的，即：对象() 或者 类()()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;__call__&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Foo() <span class="comment"># 执行 __init__</span></span><br><span class="line">obj()       <span class="comment"># 执行 __call__</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>[toc]</p>

    </div>
    
    <div class="post-footer">
        <div>
            
            转载声明：
            商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">Qilitang</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    <a href="/2017/03/05/python%2023%20GIL%20%E5%85%A8%E5%B1%80%E8%A7%A3%E9%87%8A%E5%99%A8%E9%94%81/" class="pre-post btn btn-default" title='GIL全局解释器锁'>
        <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
        <span class="hidden-xs">
            GIL全局解释器锁</span>
    </a>
    
    
    <a href="/2017/03/01/python%2021%20%E5%8F%8D%E5%B0%84%E5%8F%8A%E5%86%85%E7%BD%AE%E6%96%B9%E6%B3%95/" class="next-post btn btn-default" title='反射及内置方法'>
        <span class="hidden-lg">下一篇</span>
        <span class="hidden-xs">
            反射及内置方法</span><i class="fa fa-angle-right fa-fw"></i>
    </a>
    
</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            Table of Contents
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-isinstance-obj-cls-%E5%92%8Cissubclass-sub-super"><span class="toc-text">一 isinstance(obj,cls)和issubclass(sub,super)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%8F%8D%E5%B0%84"><span class="toc-text">二 反射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-setattr-delattr-getattr"><span class="toc-text">三 setattr,delattr,getattr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E4%BA%8C%E6%AC%A1%E5%8A%A0%E5%B7%A5%E6%A0%87%E5%87%86%E7%B1%BB%E5%9E%8B-%E5%8C%85%E8%A3%85"><span class="toc-text">四 二次加工标准类型(包装)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-getattribute"><span class="toc-text">五 __getattribute __</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E6%8F%8F%E8%BF%B0%E7%AC%A6-get-set-delete"><span class="toc-text">六 描述符(get,set,delete)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E5%86%8D%E7%9C%8Bproperty"><span class="toc-text">六 再看property</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-setitem-getitem-delitem"><span class="toc-text">七 setitem,__getitem,delitem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-str-repr-format"><span class="toc-text">八 str,repr,format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D-slots"><span class="toc-text">九  __slots__</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81-next-%E5%92%8C-iter-%E5%AE%9E%E7%8E%B0%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%8D%8F%E8%AE%AE"><span class="toc-text">十 __next__和__iter__实现迭代器协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80-doc"><span class="toc-text">十一 __doc__</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C-module-%E5%92%8C-class"><span class="toc-text">十二 __module__和__class__</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89-del"><span class="toc-text">十三  __del__</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B-enter-%E5%92%8C-exit"><span class="toc-text">十四 __enter__和__exit__</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%94-call"><span class="toc-text">十五 call</span></a>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2017
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="#" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>




<script src="/js/app.js?rev=@@hash.js"></script>


</body>
</html>